<VirtualHost *:443>
  SSLEngine on
  SSLCertificateFile /etc/ssl/certs/apache.crt
  SSLCertificateKeyFile /etc/ssl/private/apache.key
	
	ServerAdmin ${APACHE_SERVERADMIN}
    
	ServerName ${APACHE_SERVERNAME}
	ServerAlias ${APACHE_SERVERALIAS}

	DocumentRoot ${NEXTCLOUD_DOCUMENTROOT}
	Alias /nextcloud "${NEXTCLOUD_DOCUMENTROOT}"
	<Directory ${NEXTCLOUD_DOCUMENTROOT}>
		Options Indexes FollowSymLinks
		AllowOverride All
		Order allow,deny
		Allow from all
		# based on https://docs.nextcloud.com/server/9/admin_manual/installation/source_installation.html#apache-configuration-label
		<IfModule mod_dav.c>
			 Dav off
		</IfModule>
		<IfModule mod_headers.c>
			SetEnv HOME ${NEXTCLOUD_DOCUMENTROOT}
			Header always set Strict-Transport-Security "max-age=15552000"
		</IfModule>
	</Directory>

	ErrorLog ${APACHE_LOG_DIR}/error.log
	
	# Possible values include: debug, info, notice, warn, error, crit,
	# alert, emerg.
	LogLevel warn

	CustomLog ${APACHE_LOG_DIR}/access.log combined
</VirtualHost>
